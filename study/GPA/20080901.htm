<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>上海交通大学本科生GPA计算器 - 你的阳光学习频道 study.yoursunny.com</title>
<!-- GPA计算器20080901旧版，移植到yoursunny.com 2009版风格 -->
<meta name="robots" content="noindex" />
<link rel="stylesheet" type="text/css" href="/images/9/" />
<script type="text/javascript" src="/lib/9.js?cdn,tinymce"></script>
<script type="text/javascript">//<![CDATA[
var compatModeCookie=Cookie.get('GPA_compatMode');
var compatMode=(compatModeCookie==null)?((!Prototype.Browser.IE && !Prototype.Browser.Gecko && !Prototype.Browser.WebKit)):(compatModeCookie=='yes');//是否工作于兼容模式
if (compatMode) Event.bindReady(function(){$$('.tip_compat').each(function(d){d.show();})});
Cookie.set('GPA_compatMode',compatMode?'yes':'no');
//]]></script>
<style type="text/css">/*<![CDATA[*/
.mceExternalToolbar { display:none !important; }
#update_history { margin:0; padding:0; list-style:none; }
.p-body p { margin-bottom:18px; }
/*]]>*/</style>
</head><body>

<div class="header">
<h2><a href="http://yoursunny.com/">你的阳光</a></h2>
<ul>
<li><a href="http://m.yoursunny.com/"><span>个人</span></a></li>
<li><a href="http://study.yoursunny.com/"><span>学习</span></a></li>
<li><a href="http://www.65536.cn/"><span>技术</span></a></li>
<li><a href="http://www.65536.cn/work/"><span>作品</span></a></li>
</ul>
<ol>
<li><a href="/">你的阳光</a></li>
<li><a href="../">学习频道</a></li>
<li><a href="./">阳光GPA计算器</a></li>
<li><span>20080901旧版</span></li>
</ol>
</div>

<div class="content"><div class="main">

<div class="p"><div class="p-wrap">
<h1 class="tit">上海交通大学本科生GPA计算器</h1>
<div class="p-body">

<p>2008-12-03，GPA计算器已经推出新版！<a href="./">立即尝鲜新版GPA计算器</a><br/><br/><br/></p>
<input id="use_compatMode" type="checkbox" />使用兼容模式（兼容模式支持所有浏览器，标准模式只支持Firefox、IE、Safari、Chrome）<br />
<hr />
<p>最方便快捷的GPA计算工具：无需手工录入每门课程的成绩，只需使用教务处“本科修业情况查询”功能查出报表，全选页面、粘贴在下面，即可完成计算！</p>
<p><b>第一步</b>：访问<a href="http://202.120.33.84/xsbyshj/" target="_blank">本科修业情况查询</a>，用你的jAccount登录(用户名密码与交大邮箱、portal个人存储FTP相同)。出现结果后，<span class="tip_compat" style="display:none;">点击菜单：查看-源文件(View-Source)，</span>按下CTRL+A键全选，按下CTRL+C键复制，然后点击下面的文本框、按下CTRL+V键粘贴。</p>
<textarea id="xsbyshj_h" rows="3" cols="50" style="width:500px;height:100px;"></textarea>
<script type="text/javascript">//<![CDATA[
if (!compatMode) {
	WebSite.TinyMCE.init(
		{
			plugins:'',
			theme_advanced_toolbar_location:'external',
			theme_advanced_buttons1:'',
			theme_advanced_buttons2:'',
			theme_advanced_buttons3:''
		},
		{
			plugins:''
		}
	);
	WebSite.TinyMCE.create('xsbyshj_h',500,100);
}
//]]></script>
<p><b>第二步</b>：选择算法<br />
<input type="radio" name="algorithm" checked="checked" value="sjtu" onclick="algorithm=this.value;" />上海交通大学(<a href="http://jwc.sjtu.edu.cn/2007.pdf" target="_blank">学生手册第28页</a>) 4.3,4.0,...,1.0<br />
<input type="radio" name="algorithm" value="us1" onclick="algorithm=this.value;" />美国1(<a href="http://www.taisha.org/bbs/viewthread.php?tid=31209" target="_blank">此帖1</a>) 4.0,3.0,2.0,1.0<br />
<input type="radio" name="algorithm" value="us2" onclick="algorithm=this.value;" />美国2(<a href="http://www.taisha.org/bbs/viewthread.php?tid=31209" target="_blank">此帖2</a>) 4.0,3.5,...,1.0<br />
<input type="radio" name="algorithm" value="us3" onclick="algorithm=this.value;" />美国3(<a href="http://www.taisha.org/bbs/viewthread.php?tid=31209" target="_blank">此帖3</a>) 4.0,3.7,...,1.0<br />
<input type="radio" name="algorithm" value="pku" onclick="algorithm=this.value;" />北京大学(<a href="http://forum.liuxuehome.com/showtopic-18288.aspx" target="_blank">此帖</a>) 4.0,3.7,...,1.0<br />
<input type="radio" name="algorithm" value="canada" onclick="algorithm=this.value;" />加拿大(<a href="http://www.wrsacc.net/CountryOfAbroad/ArticleShow.asp?ArticleID=664" target="_blank">此文</a>) 4.3,4.0,...,2.3<br />
</p>
<p><b>第三步</b>：点击<input type="button" value="计算" onclick="calc()" />，查看结果<br/>
<input type="checkbox" id="lookup_english" />显示<b>课程英文</b>名称（需要将课程名称提交给服务器；数据版本2008-09-01）<br/>
提示：免修考及格记录不计入GPA，请自行去除打勾，<a href="http://bbs.sjtu.edu.cn/bbscon?board=SJTUJWC&amp;file=M.1188354527.A" target="_blank">参看此帖</a></p>
<div id="result" class="f-clear"><br /><br /><br /><br /><br /><br /><br /><br /></div>
<div id="xsbyshj_d" style="display:none;"></div>
</div></div></div>

</div><div class="sidebar">

<div class="p"><div class="p-wrap">
<div class="p-body">
<p>本工具用于计算你的GPA。本站注重您的隐私：所有计算均在浏览器完成，不提交到服务器；本站不记录名字、成绩、GPA。</p>
<p>计算公式参照《上海交通大学学生手册(本科生)》2007年版本，计算结果仅供参考。事实上，当你申请出国或应聘，对方会自行计算，而不看你自己计算的GPA。</p>
</div></div></div>

<div class="ad-sidebar"></div>

</div></div>

<div class="footer">
<p class="copyright">&copy;2006-2009 yoursunny.com, All Rights Reserved</p>
<ul class="links">
<li><a href="/m/about.htm">关于本站</a></li>
<li><a href="/m/contact.htm">联系方式</a></li>
<li><a href="/m/sitemap.htm">网站地图</a></li>
</ul>
</div>

<script type="text/javascript">//<![CDATA[
$('use_compatMode').checked=compatMode;
Event.observe('use_compatMode','click',function(){Cookie.set('GPA_compatMode',$('use_compatMode').checked?'yes':'no');location=location;});

var data;
var algorithm='sjtu';
function calc()
{
	fetch();
	if (!english_lookup()) count();
}
function fetch()
{
	data=new Object();
	$('xsbyshj_d').update(compatMode?
		$('xsbyshj_h').value
		:WebSite.TinyMCE.getHTML('xsbyshj_h'));
	var dom=$('xsbyshj_d');
	var TABLEs=dom.select('table');
	var id=0;
	TABLEs.each(function(TABLE,i){
		var TRs=TABLE.select('tr');
		TRs.each(function(TR){
			var TDs=TR.select('td');
			if (TDs.length<8) return;
			var code=TDs[1].firstChild.nodeValue.strip();
			if (code=='课程代码') return;
			var name=TDs[2].firstChild.nodeValue.strip();
			var credit=parseFloat(TDs[5].firstChild.nodeValue,10);
			var percent=parseInt(TDs[6].firstChild.nodeValue,10);
			data[id]={id:id,include:[1,5].include(i),code:code,name:name,credit:credit,percent:percent,english:' '};
			++id;
		});
	});
}
function count()
{
	var b='<table border="1" cellspacing="0" cellpadding="1">\n<tr><th>&nbsp;</th><th>代码</th><th>中文名称</th><th>英文名称</th><th>学分</th><th>成绩</th><th>积点</th></tr>\n';
	var totalCourses=0;//已修读课程计数
	var totalPercent=0;//∑成绩×学分
	var totalPoint=0;//∑学分×积点
	var totalCredit=0;//∑学分
	Object.values(data).each(function(d){
		var point=percent2point(d.percent);
		b+='<tr><td><input type="checkbox" id="include_'+d.id+'"'+(d.include?' checked="checked"':'')+' on'+(Prototype.Browser.IE?'click':'change')+'="include('+d.id+')" /></td><td>'+d.code+'</td><td>'+d.name+'</td><td>'+d.english+'</td><td>'+d.credit+'</td><td>'+d.percent+'</td><td>'+point+'</td></tr>';
		if (!d.include) return;
		++totalCourses;
		totalPercent+=d.credit*d.percent;
		totalPoint+=d.credit*point;
		totalCredit+=d.credit;
	});
	var brief='<p>'+totalCourses+'门课程<br/>总学积分=∑(学分×成绩)/∑学分='+(totalPercent/totalCredit)+'<br/>总平均积点GPA=∑(学分×积点)/∑学分='+(totalPoint/totalCredit)+'<br/>只有打勾的课程计算在内，其他课程不计算</p>';
	b=brief+b+'</table>'+brief;
	$('result').update(b);
}
function include(id)
{
	var included=$('include_'+id).checked;
	data[id].include=included;
	count();
}
function percent2point(p)//求百分制分数对应的积点
{
	switch (algorithm)
	{
	case 'sjtu':
		if (p>=95) return 4.3;
		if (p>=90) return 4.0;
		if (p>=85) return 3.7;
		if (p>=80) return 3.3;
		if (p>=75) return 3.0;
		if (p>=70) return 2.7;
		if (p>=67) return 2.3;
		if (p>=65) return 2.0;
		if (p>=62) return 1.7;
		if (p>=60) return 1.0;
		return 0;
	case 'us1':
		if (p>=90) return 4.0;
		if (p>=80) return 3.0;
		if (p>=70) return 2.0;
		if (p>=60) return 1.0;
		return 0;
	case 'us2':
		if (p>=90) return 4.0;
		if (p>=85) return 3.5;
		if (p>=80) return 3.0;
		if (p>=75) return 2.5;
		if (p>=70) return 2.0;
		if (p>=65) return 1.5;
		if (p>=60) return 1.0;
		return 0;
	case 'us3':
		if (p>=90) return 4.0;
		if (p>=87) return 3.7;
		if (p>=83) return 3.3;
		if (p>=80) return 3.0;
		if (p>=77) return 2.7;
		if (p>=73) return 2.3;
		if (p>=70) return 2.7;
		if (p>=60) return 1.0;
		return 0;
	case 'pku':
		if (p>=90) return 4.0;
		if (p>=85) return 3.7;
		if (p>=82) return 3.3;
		if (p>=78) return 3.0;
		if (p>=75) return 2.7;
		if (p>=72) return 2.3;
		if (p>=68) return 2.0;
		if (p>=64) return 1.5;
		if (p>=60) return 1.0;
		return 0;
	case 'canada':
		if (p>=90) return 4.3;
		if (p>=85) return 4.0;
		if (p>=80) return 3.7;
		if (p>=75) return 3.3;
		if (p>=70) return 3.0;
		if (p>=65) return 2.7;
		if (p>=60) return 2.3;
		return 0;
	}
	return 0;
}
function english_lookup() {
	if (!$('lookup_english').checked) return false;
	new Ajax.Request('translator.php',{contentType:'text/plain',postBody:Object.values(data).pluck('name').join('\n'),onComplete:english_resp});
	return true;
}
function english_resp(resp) {
	var a=resp.responseJSON;
	Object.values(data).each(function(r){
		if (a[r.name]) r.english=a[r.name];
	});
	count();
}
//]]></script>
</body></html>